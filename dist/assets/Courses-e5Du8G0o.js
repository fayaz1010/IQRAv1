import{Y as V,e as K,r as l,w as z,i as C,x as $,y as J,z as X,j as e,f as o,T as d,I as f,am as R,a5 as Z,ah as ee,a0 as O,a1 as F,l as te,h as U,C as se,E as ae}from"./index-NbX1JcnA.js";import{C as re}from"./Container-Xllwi1gj.js";import{B as j}from"./Button-BugPEW2g.js";import{A as oe}from"./Add-DJ7EsDaO.js";import{G as _}from"./Grid-D4usHc3i.js";import{C as ie,a as ne}from"./CardContent-GC4ifVzl.js";import{m as le}from"./proxy-D2rYx3pK.js";import{W as ce}from"./Edit-BL9613mr.js";import{C as B}from"./Delete-BBT7Eckp.js";import{D as ue}from"./Dialog-DxCc320D.js";import{D as de}from"./DialogTitle-D-CYvDlS.js";import{D as xe,a as me}from"./DialogContent-BKdfl9fq.js";import{T as he,a as w}from"./Tabs-BFpWoaKh.js";import{T as c}from"./TextField-BvzYVYPy.js";import{A as Y}from"./Autocomplete-D9MstP6g.js";import{Y as pe,L as je}from"./YouTube-DOr2ko_V.js";import{L as M,a as H}from"./ListItem-CES74IAT.js";import"./useThemeProps-DPqPURvD.js";import"./KeyboardArrowRight-DO8ZDbbz.js";import"./Select-DoWYHUS9.js";import"./isMuiElement-CyZXsiQS.js";import"./Close-BMBH_CLD.js";const be=["Iqra Book 1","Iqra Book 2","Iqra Book 3","Iqra Book 4","Iqra Book 5","Iqra Book 6"],ke=["Al-Fatiha","Al-Baqarah","Al-Imran"],S=({children:n,value:x,index:m,...v})=>e.jsx("div",{role:"tabpanel",hidden:x!==m,id:`course-tabpanel-${m}`,...v,children:x===m&&e.jsx(o,{sx:{p:3},children:n})}),_e=()=>{const n=V(),{currentUser:x}=K(),[m,v]=l.useState([]),[Q,D]=l.useState(!1),[b,L]=l.useState(null),[k,T]=l.useState(0),[a,i]=l.useState({title:"",description:"",objectives:"",iqraBooks:[],iqraPages:"",youtubeLinks:[],websiteLinks:[],quranContent:[],materials:[]}),[h,y]=l.useState({youtubeLink:"",websiteLink:""}),[A,p]=l.useState("");l.useEffect(()=>{I()},[x]);const I=async()=>{try{const t=z(C,"courses"),s=$(t,J("teacherId","==",x.uid)),r=await X(s),u=[];r.forEach(g=>{u.push({id:g.id,...g.data()})}),v(u)}catch(t){console.error("Error fetching courses:",t),p("Failed to load courses")}},E=(t=null)=>{t?(L(t),i({title:t.title,description:t.description,objectives:t.objectives,iqraBooks:t.iqraBooks||[],iqraPages:t.iqraPages||"",youtubeLinks:t.youtubeLinks||[],websiteLinks:t.websiteLinks||[],quranContent:t.quranContent||[],materials:t.materials||[]})):(L(null),i({title:"",description:"",objectives:"",iqraBooks:[],iqraPages:"",youtubeLinks:[],websiteLinks:[],quranContent:[],materials:[]})),D(!0),T(0)},q=()=>{D(!1),L(null),p("")},W=t=>{const s=h[t];s&&(i(r=>({...r,[t==="youtubeLink"?"youtubeLinks":"websiteLinks"]:[...r[t==="youtubeLink"?"youtubeLinks":"websiteLinks"],s]})),y(r=>({...r,[t]:""})))},P=(t,s)=>{i(r=>({...r,[t]:r[t].filter((u,g)=>g!==s)}))},G=async()=>{try{if(!a.title){p("Title is required");return}const t={...a,teacherId:x.uid,updatedAt:new Date().toISOString()};b?await te(U(C,"courses",b.id),t):(t.createdAt=new Date().toISOString(),await se(z(C,"courses"),t)),q(),I()}catch(t){console.error("Error saving course:",t),p("Failed to save course")}},N=async t=>{try{await ae(U(C,"courses",t)),I()}catch(s){console.error("Error deleting course:",s),p("Failed to delete course")}};return e.jsxs(re,{maxWidth:"lg",sx:{mt:4,mb:4,minHeight:"100vh",backgroundColor:n.palette.background.default,color:n.palette.text.primary},children:[e.jsxs(o,{sx:{mb:4},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[e.jsx(d,{variant:"h4",children:"Course Management"}),e.jsx(j,{variant:"contained",startIcon:e.jsx(oe,{}),onClick:()=>E(),children:"Create Course"})]}),e.jsx(_,{container:!0,spacing:3,children:m.map(t=>{var s;return e.jsx(_,{item:!0,xs:12,md:6,children:e.jsx(ie,{component:le.div,whileHover:{scale:1.02},whileTap:{scale:.98},sx:{backgroundColor:n.palette.background.paper,color:n.palette.text.primary},children:e.jsxs(ne,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsx(d,{variant:"h6",children:t.title}),e.jsxs(o,{children:[e.jsx(f,{size:"small",onClick:()=>E(t),sx:{mr:1},children:e.jsx(ce,{})}),e.jsx(f,{size:"small",onClick:()=>N(t.id),children:e.jsx(B,{})})]})]}),e.jsx(d,{color:"textSecondary",gutterBottom:!0,children:t.description}),((s=t.iqraBooks)==null?void 0:s.length)>0&&e.jsxs(o,{sx:{mt:2},children:[e.jsx(d,{variant:"subtitle2",gutterBottom:!0,children:"Iqra Books:"}),e.jsx(o,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.iqraBooks.map((r,u)=>e.jsx(R,{label:r,size:"small",icon:e.jsx(Z,{})},u))})]})]})})},t.id)})})]}),e.jsxs(ue,{open:Q,onClose:q,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{backgroundColor:n.palette.background.paper,color:n.palette.text.primary}},children:[e.jsx(de,{children:b?"Edit Course":"Create New Course"}),e.jsxs(xe,{children:[e.jsx(o,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(he,{value:k,onChange:(t,s)=>T(s),children:[e.jsx(w,{label:"Basic Info"}),e.jsx(w,{label:"Materials"}),e.jsx(w,{label:"Content"})]})}),A&&e.jsx(d,{color:"error",sx:{mt:2},children:A}),e.jsxs(S,{value:k,index:0,children:[e.jsx(c,{fullWidth:!0,label:"Course Title",value:a.title,onChange:t=>i({...a,title:t.target.value}),sx:{mb:2}}),e.jsx(c,{fullWidth:!0,label:"Description",value:a.description,onChange:t=>i({...a,description:t.target.value}),multiline:!0,rows:3,sx:{mb:2}}),e.jsx(c,{fullWidth:!0,label:"Course Objectives",value:a.objectives,onChange:t=>i({...a,objectives:t.target.value}),multiline:!0,rows:3})]}),e.jsxs(S,{value:k,index:1,children:[e.jsx(Y,{multiple:!0,options:be,value:a.iqraBooks,onChange:(t,s)=>i({...a,iqraBooks:s}),renderInput:t=>e.jsx(c,{...t,label:"Select Iqra Books",sx:{mb:2}}),renderTags:(t,s)=>t.map((r,u)=>e.jsx(R,{icon:e.jsx(ee,{}),label:r,...s({index:u})}))}),e.jsx(c,{fullWidth:!0,label:"Specific Pages (optional)",value:a.iqraPages,onChange:t=>i({...a,iqraPages:t.target.value}),helperText:"Enter page numbers or ranges (e.g., 1-5, 7, 10-12)",sx:{mb:2}}),e.jsx(Y,{multiple:!0,freeSolo:!0,options:ke,value:a.quranContent,onChange:(t,s)=>i({...a,quranContent:s}),renderInput:t=>e.jsx(c,{...t,label:"Quran Content",helperText:"Enter Surah names or specific verses"})})]}),e.jsxs(S,{value:k,index:2,children:[e.jsxs(o,{sx:{mb:3},children:[e.jsx(d,{variant:"subtitle1",gutterBottom:!0,children:"YouTube Links"}),e.jsxs(o,{sx:{display:"flex",gap:1,mb:1},children:[e.jsx(c,{fullWidth:!0,size:"small",placeholder:"Enter YouTube URL",value:h.youtubeLink,onChange:t=>y({...h,youtubeLink:t.target.value})}),e.jsx(j,{variant:"contained",onClick:()=>W("youtubeLink"),startIcon:e.jsx(pe,{}),children:"Add"})]}),e.jsx(O,{dense:!0,children:a.youtubeLinks.map((t,s)=>e.jsxs(M,{children:[e.jsx(F,{primary:t}),e.jsx(H,{children:e.jsx(f,{edge:"end",size:"small",onClick:()=>P("youtubeLinks",s),children:e.jsx(B,{})})})]},s))})]}),e.jsxs(o,{children:[e.jsx(d,{variant:"subtitle1",gutterBottom:!0,children:"Website Links"}),e.jsxs(o,{sx:{display:"flex",gap:1,mb:1},children:[e.jsx(c,{fullWidth:!0,size:"small",placeholder:"Enter website URL",value:h.websiteLink,onChange:t=>y({...h,websiteLink:t.target.value})}),e.jsx(j,{variant:"contained",onClick:()=>W("websiteLink"),startIcon:e.jsx(je,{}),children:"Add"})]}),e.jsx(O,{dense:!0,children:a.websiteLinks.map((t,s)=>e.jsxs(M,{children:[e.jsx(F,{primary:t}),e.jsx(H,{children:e.jsx(f,{edge:"end",size:"small",onClick:()=>P("websiteLinks",s),children:e.jsx(B,{})})})]},s))})]})]})]}),e.jsxs(me,{children:[e.jsx(j,{onClick:q,children:"Cancel"}),e.jsx(j,{onClick:G,variant:"contained",children:b?"Update":"Create"})]})]})]})};export{_e as default};
