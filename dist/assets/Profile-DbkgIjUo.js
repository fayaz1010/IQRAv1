import{e as C,r as l,j as e,P as S,f as x,U as P,D as E,L as b,h as j,i as y,k as w,l as D}from"./index-NbX1JcnA.js";import{H as g}from"./History-TrlvX2Hj.js";import{C as W}from"./Container-Xllwi1gj.js";import{S as k}from"./Stack-BFhCfF0v.js";import{A as v}from"./Alert-CmfgxPu4.js";import{T as d}from"./TextField-BvzYVYPy.js";import{B as n}from"./Button-BugPEW2g.js";import"./useThemeProps-DPqPURvD.js";import"./Close-BMBH_CLD.js";import"./Select-DoWYHUS9.js";import"./isMuiElement-CyZXsiQS.js";const z=()=>{const{currentUser:t}=C(),[s,a]=l.useState({displayName:"",phoneNumber:"",address:"",bio:""}),[o,u]=l.useState(!1),[m,c]=l.useState(""),[h,f]=l.useState("");l.useEffect(()=>{(async()=>{try{const i=j(y,"users",t.uid),p=await w(i);p.exists()&&a({...s,...p.data()})}catch(i){console.error("Error fetching profile:",i),c("Failed to load profile")}})()},[t]);const N=async r=>{r.preventDefault(),c(""),f("");try{const i=j(y,"users",t.uid);await D(i,{displayName:s.displayName,phoneNumber:s.phoneNumber,address:s.address,bio:s.bio}),f("Profile updated successfully"),u(!1)}catch(i){console.error("Error updating profile:",i),c("Failed to update profile")}};return e.jsx(W,{maxWidth:"md",sx:{mt:4,mb:4},children:e.jsxs(S,{sx:{p:4},children:[e.jsx(x,{sx:{mb:4,textAlign:"center"},children:e.jsx(P,{userData:t,variant:"full",showProgress:!0})}),e.jsx(E,{sx:{my:3}}),e.jsx("form",{onSubmit:N,children:e.jsxs(k,{spacing:3,children:[m&&e.jsx(v,{severity:"error",children:m}),h&&e.jsx(v,{severity:"success",children:h}),e.jsx(d,{label:"Display Name",value:s.displayName||"",onChange:r=>a({...s,displayName:r.target.value}),disabled:!o,fullWidth:!0,required:!0}),e.jsx(d,{label:"Phone Number",value:s.phoneNumber||"",onChange:r=>a({...s,phoneNumber:r.target.value}),disabled:!o,fullWidth:!0,required:!0}),e.jsx(d,{label:"Address",value:s.address||"",onChange:r=>a({...s,address:r.target.value}),disabled:!o,fullWidth:!0,multiline:!0,rows:2}),e.jsx(d,{label:"Bio",value:s.bio||"",onChange:r=>a({...s,bio:r.target.value}),disabled:!o,fullWidth:!0,multiline:!0,rows:4}),e.jsx(x,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:o?e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"outlined",onClick:()=>u(!1),children:"Cancel"}),e.jsx(n,{type:"submit",variant:"contained",children:"Save Changes"})]}):e.jsx(n,{variant:"contained",onClick:()=>u(!0),children:"Edit Profile"})})]})}),(t==null?void 0:t.role)==="student"&&e.jsx(n,{component:b,to:`/sessions/history?student=${t.id}`,startIcon:e.jsx(g,{}),variant:"outlined",fullWidth:!0,sx:{mt:2},children:"View Learning History"}),(t==null?void 0:t.role)==="teacher"&&e.jsx(n,{component:b,to:"/sessions/history",startIcon:e.jsx(g,{}),variant:"outlined",fullWidth:!0,sx:{mt:2},children:"View Teaching History"})]})})};export{z as default};
