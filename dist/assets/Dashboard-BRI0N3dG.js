import{d as g,j as e,e as U,r as p,x as j,y as d,w as v,a7 as G,f as A,T as m,S as Q,P as W,a0 as V,a1 as b,I,i as c,z as w,h as z,l as E}from"./index-NbX1JcnA.js";import{C as $}from"./Container-Xllwi1gj.js";import{B as q}from"./Button-BugPEW2g.js";import{G as n}from"./Grid-D4usHc3i.js";import{P as N}from"./People-CcVNbQB0.js";import{m as T}from"./proxy-D2rYx3pK.js";import{L as H,a as O}from"./ListItem-CES74IAT.js";import{C as F}from"./Close-D2ySPaYt.js";import{S as J}from"./Snackbar-CkYnnWCh.js";import{A as K}from"./Alert-CmfgxPu4.js";import{C as X,a as Y}from"./CardContent-GC4ifVzl.js";import"./useThemeProps-DPqPURvD.js";import"./isMuiElement-CyZXsiQS.js";import"./Close-BMBH_CLD.js";const L=g(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment"),Z=g(e.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),_=g(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"Warning"),xe=()=>{const{currentUser:i}=U(),[l,y]=p.useState({activeUsers:0,activeClasses:0,pendingApprovals:0,systemHealth:"Good"}),[f,P]=p.useState([]),[u,a]=p.useState({open:!1,message:"",severity:"success"});p.useEffect(()=>{if(!(i!=null&&i.role)==="admin")return;const s=j(v(c,"users"),d("role","==","teacher"),d("status","==","pending")),r=G(s,t=>{const x=t.docs.map(o=>({id:o.id,...o.data()}));P(x),y(o=>({...o,pendingApprovals:x.length}))},t=>{console.error("Error fetching pending teachers:",t),a({open:!0,message:"Error fetching pending teachers",severity:"error"})});return(async()=>{try{const t=j(v(c,"users"),d("status","==","active")),o=(await w(t)).size,R=j(v(c,"classes"),d("status","==","active")),B=(await w(R)).size;y(M=>({...M,activeUsers:o,activeClasses:B}))}catch(t){console.error("Error fetching stats:",t),a({open:!0,message:"Error fetching dashboard statistics",severity:"error"})}})(),()=>r()},[i]);const h=({title:s,value:r,icon:S,color:t})=>e.jsx(X,{component:T.div,whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsxs(Y,{children:[e.jsxs(A,{sx:{display:"flex",alignItems:"center",mb:2},children:[S,e.jsx(m,{variant:"h6",sx:{ml:1},children:s})]}),e.jsx(m,{variant:"h4",color:t,children:r})]})}),k=async s=>{try{const r=z(c,"users",s);await E(r,{status:"active"}),a({open:!0,message:"Teacher approved successfully",severity:"success"})}catch(r){console.error("Error approving teacher:",r),a({open:!0,message:"Error approving teacher",severity:"error"})}},D=async s=>{try{const r=z(c,"users",s);await E(r,{status:"rejected"}),a({open:!0,message:"Teacher rejected",severity:"success"})}catch(r){console.error("Error rejecting teacher:",r),a({open:!0,message:"Error rejecting teacher",severity:"error"})}},C=()=>{a(s=>({...s,open:!1}))};return e.jsxs($,{maxWidth:"lg",sx:{mt:4,mb:4},children:[e.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[e.jsx(m,{variant:"h4",children:"Admin Dashboard"}),e.jsx(q,{variant:"contained",color:"primary",startIcon:e.jsx(L,{}),onClick:()=>{},children:"System Reports"})]}),e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Active Users",value:l.activeUsers,icon:e.jsx(N,{color:"primary"}),color:"primary"})}),e.jsx(n,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Active Classes",value:l.activeClasses,icon:e.jsx(Q,{color:"secondary"}),color:"secondary"})}),e.jsx(n,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"Pending Approvals",value:l.pendingApprovals,icon:e.jsx(L,{color:"warning"}),color:"warning"})}),e.jsx(n,{item:!0,xs:12,sm:6,md:3,children:e.jsx(h,{title:"System Health",value:l.systemHealth,icon:e.jsx(_,{color:"success"}),color:"success"})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(W,{sx:{p:2},component:T.div,initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsx(m,{variant:"h6",gutterBottom:!0,children:"Pending Teacher Approvals"}),e.jsxs(V,{children:[f.map(s=>e.jsxs(H,{children:[e.jsx(b,{primary:s.email,secondary:`Role: ${s.role} - Status: ${s.status}`}),e.jsxs(O,{children:[e.jsx(I,{edge:"end","aria-label":"approve",onClick:()=>k(s.id),color:"success",sx:{mr:1},children:e.jsx(Z,{})}),e.jsx(I,{edge:"end","aria-label":"reject",onClick:()=>D(s.id),color:"error",children:e.jsx(F,{})})]})]},s.id)),f.length===0&&e.jsx(H,{children:e.jsx(b,{primary:"No pending teacher approvals"})})]})]})})]}),e.jsx(J,{open:u.open,autoHideDuration:6e3,onClose:C,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(K,{onClose:C,severity:u.severity,children:u.message})})]})};export{xe as default};
